{% extends 'dashboard_base.html' %}
{% load static %}
{% csrf_token %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
     /* Import the Inter font with the necessary weights */

    body {
        background-image: {% static 'kgx_app/bg_kgx.png' %};
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center center;
        font-family: Inter, sans-serif; /* Apply Inter font globally */
    }

    /* Media query for responsiveness */
    @media (max-width: 768px) {
        .container {
            flex-direction: column;
            padding: 20px; /* Increase padding for a more spacious feel */
            height: auto; /* Allow the container to grow naturally */
        }
    
        .section-one,
        .section-two {
            width: 100%; /* Ensure both sections take full width */
            margin: 0 0 20px 0; /* Add spacing between sections */
        }
    
        .box-one, 
        .box-two {
            padding: 15px; /* Reduce padding to make content fit better */
            margin-bottom: 20px; /* Increase spacing between boxes */
        }
    
        .box-one h2 {
            font-size: 28px; /* Decrease font size for smaller screens */
            line-height: 34px; /* Adjust line height */
        }
    
        .box-one p {
            font-size: 16px; /* Smaller text size for readability */
        }
    
        .percentage-container {
            width: 120px; /* Reduce size for smaller screens */
            height: 120px;
        }
    
        .split-box {
            font-size: 16px; /* Reduce font size in split-boxes */
            padding: 8px; /* Adjust padding for smaller text */
        }
    
        .comment-section {
            padding: 15px; /* Reduce padding for a compact look */
        }
    
        .comment img {
            width: 40px; /* Adjust avatar size */
            height: 40px;
        }
    
        .comment-box input {
            width: 70%; /* Adjust input width for better fit */
            padding: 10px; /* Slightly reduce padding */
        }
    
        .comment-box button {
            width: 45px; /* Adjust button size */
            height: 45px;
        }
    }    

    .container {
        display: flex;
        height: 100vh;
    }

    .section-one {
        width: 40%;
        display: flex;
        flex-direction: column;
        margin-right: 20px;
    }
    .section-two {
        width: 60%;
        background: rgba(0, 0, 0, 0.6);
        border-radius: 5%;
        padding: 20px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .box-one {
        height: 65%;
        background: rgba(0, 0, 0, 0.6); /* Dark semi-transparent background */
        margin-bottom: 10px; /* Optional spacing between boxes */
        border-radius: 5%;
        padding: 20px; /* Add padding for better text spacing */
        font-family: 'Arial', sans-serif; /* Change font for content */
        font-size: 24px;
        font-weight: 400;
        line-height: 38px;
        text-align: center; /* Center-align the title */
        color: white; /* White text color */
        overflow: hidden; /* Prevent scrolling */
        transition: background 0.3s ease; /* Smooth background transition on hover */
    }

    .box-one:hover {
        background: rgba(0, 0, 0, 0.8); /* Darken background on hover */
    }

    .box-two {
        height: 35%;
        background: rgba(0, 0, 0, 0.6); /* Dark semi-transparent background */
        border-radius: 5%;
        display: flex;
        flex-direction: row;
    }

    .box-two .section-one {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .box-two .section-two {
        flex: 1;
        display: flex;
        flex-direction: column;
        padding: 10px;
    }

    .box-two .percentage-container {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        background: radial-gradient(circle, #580475 40%, #333 60%); /* Radial gradient background */
        border: 8px solid #580475; /* Ring border color */
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.5), inset 0 0 10px rgba(255, 255, 255, 0.2); /* Outer and inner shadow */
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth transform and shadow transitions */
    }

    .box-two .percentage-container::before {
        content: attr(data-percentage);
        color: white;
        font-size: 36px; /* Larger font size */
        font-weight: bold;
        font-family: 'Arial', sans-serif; /* Different font for emphasis */
        text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.6); /* Enhanced text shadow for clarity */
    }

    .box-two .percentage-container:hover {
        transform: scale(1.1); /* Slightly enlarge on hover */
        box-shadow: 0 0 25px rgba(0, 0, 0, 0.8); /* Enhanced shadow on hover */
        background: radial-gradient(circle, #580475 30%, #333 70%); /* Change gradient on hover */
    }

    .box-two .split-boxes {
        display: flex;
        flex-direction: column;
        height: 100%;
        gap: 10px;
    }

    .box-two .split-boxes .split-box {
        background: linear-gradient(180deg, #580475 0%, #A507DB 100%);
        /* Soft, professional gradient */
        border-radius: 10px;
        flex: 1; /* Make each box take up equal height */
        display: flex;
        flex-direction: column; /* Stack text and value vertically */
        align-items: center;
        justify-content: center;
        color: white; /* Dark grey text for professionalism */
        font-size: 18px;
        font-weight: 700;
        font-family: 'Inter', sans-serif;
        transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease; /* Smooth transitions */
        position: relative;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* Soft shadow for depth */
        text-align: center; /* Center-align the text */
        padding: 10px;
    }

    .box-two .split-box:hover {
        background: linear-gradient(180deg, #580475 0%, #181817 65.34%, #000000 100%);
        /* Subtle gradient shift on hover */
        transform: translateY(-3px); /* Slight lift on hover */
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.2); /* Slightly stronger shadow on hover */
    }

    .box-two .split-box::after {
        content: '';
        position: absolute;
        top: -5px;
        left: -5px;
        right: -5px;
        bottom: -5px;
        border-radius: 10px;
        background: linear-gradient(45deg, rgba(255, 255, 255, 0.3), rgba(0, 0, 0, 0.05)); /* Subtle border gradient */
        z-index: -1;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .box-two .split-box:hover::after {
        opacity: 1; /* Show the gradient border on hover */
    }

    .box-two .split-box span {
        font-size: 24px; /* Emphasize the value */
        font-weight: bold;
        margin-top: 5px;
    }

    .box-two .split-box .additional-info {
        font-size: 14px;
        color: #0077cc; /* Professional blue for additional info */
        font-weight: bold;
        position: absolute;
        bottom: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.1);
        padding: 5px 10px;
        border-radius: 5px;
        transition: background 0.3s ease;
    }

    .box-two .split-box:hover .additional-info {
        background: rgba(0, 0, 0, 0.2); /* Darken background on hover */
    }

    .box-one h2 {
        font-family: 'Arial', sans-serif;
        font-size: 40px;
        font-weight: 600;
        line-height: 32px;
        text-align: center;
        margin-top: 0;
        margin-bottom: 20px;
        color: white;
        transition: color 0.3s ease;
    }

    .box-one:hover h2 {
        color: #580475; /* Change title color on hover */
    }

    .box-one p {
        margin: 0;
        color: white;
    }

    .box-one a {
        color: #00aaff;
        text-decoration: none;
        font-weight: bold;
        transition: color 0.3s ease;
    }

    .box-one a:hover {
        color: #0077cc; /* Darker color on hover */
        text-decoration: underline;
    }
    /* Comment Section Styles */
   /* Highlighted Comment Section Styles */
   .comment-section {
    background: rgba(0, 0, 0, 0.6); /* Dark semi-transparent background */
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1); /* Soft shadow for depth */
    border: 2px solid #580475; /* Border to frame the section */
    overflow-y: auto;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    backdrop-filter: blur(10px); /* Optional: Adds a blur effect to the background */
}

.comment {
    display: flex;
    align-items: center;
    padding: 15px;
    border-radius: 15px;
    background: rgba(255, 255, 255, 0.1); /* Semi-transparent white background for comments */
    margin-bottom: 15px;
    flex-grow: 1;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Soft shadow */
}

.comment .comment-content {
    flex-grow: 1;
    background: rgba(255, 255, 255, 0.2); /* Slightly more transparent white background for the comment content */
    padding: 15px;
    border-radius: 15px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1); /* Shadow for the comment content */
    font-size: 16px;
    line-height: 1.5;
    color: white; /* Ensure text color is white for readability */
}

.comment img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    margin-right: 15px;
    border: 2px solid #580475; /* Border around the avatar */
}


.comment .comment-content {
    flex-grow: 1;
    background: rgba(7, 6, 6, 0.9);
    padding: 15px;
    border-radius: 15px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    /* Shadow for the comment content */
    font-size: 16px;
    line-height: 1.5;
}

.comment-box {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-top: 15px;
    border-top: 2px solid rgba(0, 0, 0, 0.1);
}

.comment-box input {
    width: 75%;
    padding: 12px;
    border-radius: 10px;
    border: 2px solid #580475;
    /* Highlighted border */
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    /* Inner shadow */
}

.comment-box button {
    padding: 12px;
    width: 50px;
    height: 50px;
    border: none;
    border-radius: 50%;
    background-color: #580475;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s ease;
    font-weight: bold;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Button shadow */
    display: flex;
    align-items: center;
    justify-content: center;
}

.comment-box button:hover {
    background-color: #A507DB;
    /* Brighter color on hover */
}

.comment-box button i {
    font-size: 20px;
}
.comment-box .logo-icon {
    font-size: 24px; /* Adjust the icon size */
    color: #580475; /* Match the theme color */
    margin-right: 10px; /* Space between icon and input field */
    border-radius: 50%; /* Optional: Make it round */
    background-color: rgba(255, 255, 255, 0.1); /* Add background */
    padding: 8px; /* Space inside the icon */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Soft shadow for depth */
}




</style>


<div class="container">
    <div class="section-one">
        <div class="box-one">
            <h2>About Us</h2>
            <p>KGiSL Innovation cell (KGX) was established with the intention of encouraging young minds fuelling their entrepreneurial initiatives by solving real world problems. KGX identifies the entrepreneurial aspirants from KGiSL Institute of Technology and facilitates them to bring their idea into a viable product and eventually build a startup... <a href="#">Know more</a></p>
        </div>
        <div class="box-two">
            <div class="section-one">
                <div class="percentage-container" data-percentage="70%"></div>
            </div>
            <div class="section-two">
                <div class="split-boxes">
                    <div class="split-box">
                        Tasks Assigned : <br> <span>18</span>
                    </div>
                    <div class="split-box">
                       Tasks Completed : <br> <span>13</span>
                       
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="section-two">
        <div class="comment-section" id="comment-section">
            {% for comment in comments %}
                <div class="comment">
                    <!-- Display the profile image in a circle -->
                    <img src="{{ comment.user.profile.image.url }}" 
                    onerror="this.onerror=null; 
                    this.src='{% static 'kgx_app/default_profile.png' %}';" 
                    alt="Profile Picture" class="profile-pic" />

                    <div class="comment-content">
                        <p>{{ comment.content }}</p>
                        <p>{{ comment.profile_image }}</p> 
                    </div>
                </div>
            {% endfor %}
        </div>        
            <!-- Comment Box -->
        <div class="comment-box">
                <!-- Font Awesome Icon -->
                <i class="fas fa-comment-dots logo-icon"></i>
                <input type="text" id="comment-input" placeholder="Type your message...">
                <button id="submit-comment"><i class="fas fa-paper-plane"></i></button>
            </div> 
        </div>
    </div>
</div>

<script>
    document.getElementById('submit-comment').addEventListener('click', function() {
        const content = document.getElementById('comment-input').value.trim();
        const commentSection = document.getElementById('comment-section'); // Should now work correctly
    
        if (content) {
            fetch("{% url 'add_comment' %}", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}',
                },
                body: JSON.stringify({ content: content }),
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                if (data.success) {
                    const newComment = document.createElement('div');
                    newComment.classList.add('comment');
                    newComment.innerHTML = `
                        <img src="${data.profile_image}" alt="Commenter">
                        <div class="comment-content">${data.comment}</div>
                    `;
                    commentSection.insertBefore(newComment, commentSection.lastElementChild); // Inserts above input box
                    document.getElementById('comment-input').value = ''; // Clear input box
                } else {
                    alert("Failed to add comment: " + (data.error || "Please try again."));
                }
            })
            .catch(err => {
                console.error('Error:', err);
                alert("An error occurred while submitting the comment. Please try again.");
            });
        } else {
            alert("Please enter a comment before submitting.");
        }
    });
    </script>    
{% endblock %}
